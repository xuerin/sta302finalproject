---
title: "Modeling GDP Using Health and Socioeconomic Indicators"
author: "Erin Xu, Dora Dong, Shencen Cai, Sharon Lam"
date: "2025-05-19"
output: 
  pdf_document:
    extra_dependencies: ["bbm"]
urlcolor: blue
bibliography: references.bib
link-citations: true
---
# Contributions
**Introduction:** Sharon Lam

**Data Description:** Shencen Cai

**Preliminary Results:** Erin Xu, Dora Dong

**Bibliography:** Everyone 

# Introduction
&nbsp; Gross domestic product (GDP) is a widely used measure of a country’s economic output, representing the total market value of goods and services produced within its borders over a specified period. It serves as a key indicator of national economic performance and enables comparison across countries and time periods. By standard economic theory, GDP is influenced by components such as consumer spending, government expenditures, investment in capital goods, and net exports. In addition, factors like human capital, infrastructure, technological innovation, and political stability are considered critical for long-term economic growth (Solow, 1956).

&nbsp; This project applies multiple linear regression (MLR) to investigate the extent to which health-related and socioeconomic factors are associated with GDP, with the research question being: *To what extent do government spending on health and socioeconomic resources affect a country’s GDP?* Specifically, country status (developed vs. developing), percentage expenditure on health, polio immunization coverage, income composition of resources, years of schooling, and population are used as predictors. These variables, comprising both continuous and categorical data, are examined for their ability to explain cross-country variation in GDP. Health spending, represented by expenditure and immunization coverage, has been shown to enhance productivity, while income composition and national development status reflect broader socioeconomic conditions. Education and population are also recognized as structural drivers of economic capacity.

&nbsp; Estimating a linear model facilitates the quantification of each predictor’s contribution to GDP while accounting for the influence of other variables. As economic theory suggests a positive relationship between GDP and improved development indicators, the application of MLR is appropriate for this context. The focus of the analysis is on interpretability, aiming to understand how each factor relates to economic output and to support evidence-based approaches to development and policy planning.

# Data Description
&nbsp; The dataset used in this project is titled *Life Expectancy* (WHO), sourced from *Kaggle* (Kumar, 2018). Its primary usage is for health data analysis. Data collectors combined publicly available data from the *World Health Organization* (WHO) and the *United Nations* (UN), which were gathered through national health departments, structured questionnaires, and annual statistical submissions by participating countries (World Health Organization, n.d.; United Nations, n.d.).

&nbsp; While the dataset was initially intended to examine factors affecting life expectancy, this project selects 7 of the original 22 variables. The sample comprises over 1,600 complete observations, focusing on education, demographic, and socioeconomic indicators relevant to economic growth. These variables align with economic theory, which emphasizes the importance of education, health, and human capital in supporting sustained increases in productivity and GDP.

&nbsp; Multiple linear regression is an appropriate method for analysis, as the dataset consists of independent observations and the model assumes normally distributed residuals, which can be evaluated through diagnostic procedures.

\
Table 1: Variables used in the model

| **Variables**                   | **Description**                                                                 |
|--------------------------------|---------------------------------------------------------------------------------|
| GDP                            | Gross Domestic Product per capita (USD)                                        |
| Status                         | Developed or Developing status                                                 |
| Percentage expenditure         | Expenditure on health as a percentage of Gross Domestic Product per capita (%) |
| Polio                          | Polio immunization coverage among 1-year-olds (%)                              |
| Population                     | Population of the country                                                      |
| Income composition of resources| Human Development Index in terms of income composition (index from 0 to 1)     |
| Schooling                      | Number of years of schooling (years)                                           |


Table 2: Continuous variables summary

| Variable                         |   Mean   |   Std   |   Min   |   Q1   | Median |   Q3   |   Max    |
|----------------------------------|----------|---------|---------|--------|--------|--------|----------|
| GDP                              | 7284.31  | 14027.92| 1.68    | 1400.69| 2654.32| 6891.00| 119172.74|
| Percentage expenditure           | 4.28     | 3.76    | 0.01    | 1.32   | 3.45   | 6.33   | 87.60    |
| Polio                            | 82.53    | 23.58   | 0.00    | 78.00  | 91.00  | 97.00  | 100.00   |
| Population                       | 3.38e+07 | 1.19e+08| 366.00  | 3.35e+06|1.26e+07|3.88e+07|1.36e+09  |
| Income composition of resources  | 0.63     | 0.15    | 0.00    | 0.54   | 0.67   | 0.76   | 0.95     |
| Schooling                        | 10.30    | 2.98    | 0.00    | 8.00   | 10.30  | 12.43  | 20.00    |


Table 3: Status (categorical variable) frequency

| Status     | Frequency |
|------------|-----------|
| Developing | 2426      |
| Developed  | 512       |
| **Total**  | 2938      |


Figure 1: Scatter plots of GDP against numeric predictors
```{r message=FALSE, echo=FALSE, warning=FALSE, include=FALSE}
packages <- c("tidyverse", "latex2exp", "gridExtra", "rvest", 
              "kableExtra", "leaps", "ggplot2", "patchwork")
lapply(packages, require, character.only = T)
set.seed(420)
all_data <- read.csv("life_expectancy.csv")
```

```{r fig.width = 10, fig.length=12, echo=FALSE, message=FALSE, warning=FALSE}
scatter_plot <- function(xvar, xlab) {
  ggplot(all_data, aes_string(x = xvar, y = "GDP")) +
    geom_point(color = "black", alpha = 0.6) +
    geom_smooth(method = "lm", se = FALSE, color = "blue") +
    labs(
      title = paste("GDP vs", xlab),
      x = xlab,
      y = "GDP"
    ) +
    theme_minimal()
}

# Create plots
p1 <- scatter_plot("percentage.expenditure", "Percentage expenditure")
p2 <- scatter_plot("Polio", "Polio")
p3 <- scatter_plot("Population", "Population")
p4 <- scatter_plot("Income.composition.of.resources", "Income composition of resources")
p5 <- scatter_plot("Schooling", "Schooling")

# Combine in layout
(p1 | p2 | p3) / (p4 | p5)
```
GDP increases with higher schooling, income composition, and population, though with some spread. Percentage expenditure and polio demonstrate weaker positive trends. Education and income equality appear more strongly linked to economic growth than health spending.


Fig. 2. - Histogram of GDP & numeric predictors

```{r echo=FALSE, message=FALSE, warning=FALSE}
# Create a common theme with smaller text and better use of space
compact_theme <- theme(
  plot.title = element_text(size = 9, face = "bold"),
  axis.title = element_text(size = 8),
  axis.text = element_text(size = 7),
  plot.margin = margin(3, 3, 3, 3, "pt")
)

# Create the six histograms with the compact theme
p1 <- ggplot(all_data, aes(x = GDP)) +
  geom_histogram(binwidth = 1000, fill = "skyblue", color = "white") +
  labs(title = "Distribution of GDP", x = "GDP", y = "Frequency") +
  scale_x_continuous(
    limits = c(0, 50000),          # Set axis range from 0 to 50,000
    breaks = seq(0, 50000, 10000), # Set tick marks at intervals of 10,000
    labels = scales::comma          # Format numbers with commas
  ) +
  compact_theme

p2 <- ggplot(all_data, aes(x = percentage.expenditure)) +
  geom_histogram(binwidth = 1, fill = "skyblue", color = "white") +
  labs(title = "Distribution of % Expenditure", x = "% Expenditure", y = "Frequency") +
  scale_x_continuous(
    limits = c(0, 100),        # Reduced axis range from 0 to 100
    breaks = seq(0, 100, 20),  # Set tick marks at intervals of 20
    labels = scales::comma      # Format numbers with commas
  ) +
  scale_y_continuous(
    limits = c(0, 100),        # Y-axis range from 0 to 100
    breaks = seq(0, 100, 20)   # Y-axis tick marks at intervals of 20
  ) +
  compact_theme

p3 <- ggplot(all_data, aes(x = Polio)) +
  geom_histogram(binwidth = 2, fill = "skyblue", color = "white") +
  labs(title = "Distribution of Polio", x = "Polio", y = "Frequency") +
  compact_theme

p4 <- ggplot(all_data, aes(x = Population)) +
  geom_histogram(binwidth = 10000000, fill = "skyblue", color = "white") +
  labs(title = "Distribution of Population", x = "Population (billions)", y = "Frequency") +
  scale_x_continuous(
    limits = c(0, 1.2e9),                   # X-axis range from 0 to 1.2 billion
    breaks = seq(0, 1.2e9, 0.2e9),          # X-axis tick marks at intervals of 0.2 billion
    labels = function(x) x/1e9              # Format as billions (0, 0.2, 0.4, etc.)
  ) +
  scale_y_continuous(
    limits = c(0, 500),                    # Y-axis range from 0 to 2500
    breaks = seq(0, 500, 100)              # Y-axis tick marks at intervals of 500
  ) +
  compact_theme

p5 <- ggplot(all_data, aes(x = Income.composition.of.resources)) +
  geom_histogram(binwidth = 0.02, fill = "skyblue", color = "white") +
  labs(title = "Distribution of Income Composition", x = "Income Composition", y = "Frequency") +
  compact_theme

p6 <- ggplot(all_data, aes(x = Schooling)) +
  geom_histogram(binwidth = 0.5, fill = "skyblue", color = "white") +
  labs(title = "Distribution of Schooling", x = "Schooling", y = "Frequency") +
  compact_theme

# Use patchwork to arrange plots with custom layout
library(patchwork)
combined_plot <- (p1 | p2 | p3) / (p4 | p5 | p6)

# Apply global theme adjustments to the combined plot
combined_plot & 
  theme(plot.margin = margin(1, 1, 1, 1, "pt")) &
  plot_layout(guides = "collect")
```



GDP, percentage expenditure, and population are right-skewed, with mostly low values and a few extreme highs. Schooling and income composition are left-skewed, clustering at the high end. Polio rates are highly left-skewed. These patterns demonstrate how the predictors vary and help explain differences in GDP.

# Preliminary Results

The dataset was first loaded and examined for missing values. Observations containing any missing data were removed using listwise deletion to ensure model integrity. All relevant variables were transformed as necessary, and the categorical variable Status was converted into a factor for use in regression modeling.
```{r}
all_data <- read.csv("life_expectancy.csv", na.strings = c("", "NA"))
anyNA(all_data)
sum(is.na(all_data))
colSums(is.na(all_data))
```

## Decide predictors 
```{r eval=FALSE}
all_data <- read.csv("life_expectancy.csv")
all_data <- na.omit(all_data)

all_data$Status <- as.factor(all_data$Status)


# Clean model
full_model <- lm(GDP ~ Life.expectancy + Status + Adult.Mortality + 
                   infant.deaths + Alcohol + percentage.expenditure + 
                   Hepatitis.B + Measles + BMI + under.five.deaths + Polio +
                   Total.expenditure + Diphtheria + HIV.AIDS + Population +
                   thinness..1.19.years + thinness.5.9.years +
                   Income.composition.of.resources + Schooling,
                 data = all_data)
summary(full_model)

step_model <- step(full_model, direction = "both")
summary(step_model)
```

## Best subset selection
```{r, fig.width=10, fig.height=7}
best_model <- regsubsets(Life.expectancy ~ GDP + Status + Adult.Mortality + 
                           infant.deaths + Alcohol +
                           percentage.expenditure + Hepatitis.B + Measles + 
                           BMI + under.five.deaths + Polio +
                           Total.expenditure + Diphtheria + HIV.AIDS + 
                           Population + thinness..1.19.years + 
                           thinness.5.9.years + Income.composition.of.resources 
                          + Schooling, data = all_data, nvmax = 10)

# Summary and plot
best_summary <- summary(best_model)
plot(best_model, scale = "adjr2")
```
\
We propose the following multiple linear regression model:
$$
\begin{aligned}
GDP &= \mathbb{E}[\log(GDP)] + e \\
    &= b_0 + b_1 \cdot \text{PercentageExpenditure} + b_2 \cdot \text{Polio} + b_3 \cdot \text{Population} \\
    &\quad + b_4 \cdot \text{IncomeCompositionOfResources} + b_5 \cdot \text{Schooling} + b_6 \cdot \text{Status}
\end{aligned}
$$

## Get the response and predictors. 
```{r}
all_data <- read.csv("life_expectancy.csv")
all_data <- na.omit(all_data)
all_data$log_GDP <- log(all_data$GDP)

response <- all_data$log_GDP
x0 <- all_data$percentage.expenditure
x1 <- all_data$Polio
x2 <- all_data$Population
x3 <- all_data$Income.composition.of.resources
x4 <- all_data$Schooling

all_data$Status <- as.factor(all_data$Status)

model <- lm(response ~ Status + x0 + x1 + x2 + x3 + x4, data = all_data)
summary(model)
```
We estimate the deterministic model as: 
$$
\begin{aligned}
\hat{GDP} = \exp(&\hat{b_0} + \hat{b_1} \cdot \text{PercentageExpenditure} + \hat{b_2} \cdot \text{Polio} + \hat{b_3} \cdot \text{Population} \\
                &+ \hat{b_4} \cdot \text{IncomeCompositionOfResources} + \hat{b_5} \cdot \text{Schooling} + \hat{b_6} \cdot \text{Status})
\end{aligned}
$$
by using the $lm$ function to find the values of the coefficients that minimize the RSS. 

## Residual plots
```{r, fig.width=13, fig.height=8,}
par(mfrow = c(2, 2))
plot(model)
```

## Residual VS each predictor (Regression assumptions)
```{r, fig.width=12, fig.height=8}
all_data$residuals <- resid(model)
all_data$fitted <- fitted(model)

p1 <- ggplot(all_data, aes(x = `percentage.expenditure`, y = residuals)) +
  geom_point(alpha = 0.6) +
  geom_hline(yintercept = 0, color = "red", linetype = "dashed") +
  labs(title = "Residuals vs Percentage Expenditure")

p2 <- ggplot(all_data, aes(x = Polio, y = residuals)) +
  geom_point(alpha = 0.6) +
  geom_hline(yintercept = 0, color = "red", linetype = "dashed") +
  labs(title = "Residuals vs Polio")

p3 <- ggplot(all_data, aes(x = Population, y = residuals)) +
  geom_point(alpha = 0.6) +
  geom_hline(yintercept = 0, color = "red", linetype = "dashed") +
  labs(title = "Residuals vs Population")

p4 <- ggplot(all_data, aes(x = `Income.composition.of.resources`, 
                           y = residuals)) +
  geom_point(alpha = 0.6) +
  geom_hline(yintercept = 0, color = "red", linetype = "dashed") +
  labs(title = "Residuals vs Income Composition")

p5 <- ggplot(all_data, aes(x = Schooling, y = residuals)) +
  geom_point(alpha = 0.6) +
  geom_hline(yintercept = 0, color = "red", linetype = "dashed") +
  labs(title = "Residuals vs Schooling")

p6 <- ggplot(all_data, aes(x = as.factor(Status), y = residuals)) +
  geom_jitter(width = 0.2, alpha = 0.6, color = "steelblue") +
  geom_hline(yintercept = 0, linetype = "dashed", color = "red") +
  scale_x_discrete(labels = c("Developing", "Developed")) +
  labs(title = "Residuals vs Status",
       x = "Status",
       y = "Residuals")

(p1 | p2 | p3) / (p4 | p5 | p6)
```

## Residual VS Fitted plot (Regression assumptions)
```{r, fig.width=12, fig.height=15}
# Store residuals only once (already done earlier)
all_data$residuals <- resid(model)
all_data$std_residuals <- rstandard(model)

# Q-Q Plot
qq_plot <- ggplot(all_data, aes(sample = residuals)) +
  stat_qq() +
  stat_qq_line(color = "red", linetype = "dashed") +
  labs(title = "Q-Q Plot of Residuals") +
  theme_minimal() +  # Optional: adds a cleaner theme that may help with rendering
  theme(aspect.ratio = 1)  # Makes the plot square, which often helps QQ plots display correctly

# Standardized Q-Q Plot 
std_qq_plot <- ggplot(all_data, aes(sample = std_residuals)) +
  stat_qq() +
  stat_qq_line(color = "red", linetype = "dashed") +
  labs(title = "Q-Q Plot of Standardized Residuals") +
  theme_minimal() +
  theme(aspect.ratio = 1)

# Histogram
hist_plot <- ggplot(all_data, aes(x = residuals)) +
  geom_histogram(bins = 30, fill = "steelblue", color = "white", alpha = 0.7) +
  geom_vline(xintercept = 0, linetype = "dashed", color = "red") +
  labs(title = "Histogram of Residuals", x = "Residuals", y = "Count")

std_hist_plot <- ggplot(all_data, aes(x = std_residuals)) +
  geom_histogram(bins = 30, fill = "steelblue", color = "white", alpha = 0.7) +
  geom_vline(xintercept = 0, linetype = "dashed", color = "red") +
  labs(title = "Histogram of Standardized Residuals", 
       x = "Standardized Residuals", 
       y = "Count")


(qq_plot | std_qq_plot) / (hist_plot / std_hist_plot)
```

# Bibliography
Kumar, R. (2018, February 10). *Life expectancy (WHO)* [Data set]. Kaggle.  
&nbsp; [https://www.kaggle.com/datasets/kumarajarshi/life-expectancy-who](https://www.kaggle.com/datasets/kumarajarshi/life-expectancy-who)

Organisation for Economic Co-operation and Development. (n.d.). *Nominal gross domestic product (GDP)*. OECD.  
&nbsp; [https://www.oecd.org/en/data/indicators/nominal-gross-domestic-product-gdp.html?oecdcontrol-d7f68dbeee-var3=2023](https://www.oecd.org/en/data/indicators/nominal-gross-domestic-product-gdp.html?oecdcontrol-d7f68dbeee-var3=2023)

Radcliffe, B. (n.d.). *How education and training affect the economy*. Investopedia.  
&nbsp; [https://www.investopedia.com/articles/economics/09/education-training-advantages.asp](https://www.investopedia.com/articles/economics/09/education-training-advantages.asp)

Raghupathi, V., & Raghupathi, W. (2020, May 13). Healthcare expenditure and economic performance: Insights from the United States data. *Frontiers in Public Health, 8*, 156.  
&nbsp; [https://doi.org/10.3389/fpubh.2020.00156](https://doi.org/10.3389/fpubh.2020.00156)

Solow, R. M. (1956). A contribution to the theory of economic growth. *The Quarterly Journal of Economics, 70*(1), 65–94.  
&nbsp; [https://doi.org/10.2307/1884513](https://doi.org/10.2307/1884513)

United Nations. (n.d.). *UN data*.  
&nbsp;[https://data.un.org](https://data.un.org)

World Health Organization. (n.d.). *Global Health Observatory (GHO) data repository*.  
&nbsp;[https://www.who.int/data/gho](https://www.who.int/data/gho)
