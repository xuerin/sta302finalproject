---
title:  "Modeling GDP Using Health and Socioeconomic Indicators"
author: "Erin Xu, Dora Dong, Shencen Cai, Sharon Lam"
date: "2025-06-12"
output: 
  pdf_document:
    extra_dependencies: ["bbm"]
urlcolor: blue
bibliography: references.bib
nocite: '@*'
link-citations: true
---
# Introduction
Gross domestic product (GDP) is a widely used measure of a country’s economic output, representing the total market value of goods and services produced within its borders over a specified period. It serves as a key indicator of national economic performance and enables comparison across countries and time periods. From economic theory, GDP is influenced by components such as consumer spending, government expenditures, investment in capital goods, and net exports. Factors like human capital, infrastructure, technological innovation, and political stability are also vital.

This project applies multiple linear regression (MLR) to investigate the extent to which health-related and socioeconomic factors are associated with GDP, with the research question being: *To what extent do government spending on health and socioeconomic resources affect a country’s GDP?* Specifically, country status (developed vs. developing), percentage expenditure on health, polio immunization coverage, income composition of resources, years of schooling, and population are the combination of continuous and categorical predictors used to explain the extent in which they affect GDP in countries around the world. Health spending, represented by percent of a country's expenditure and polio immunization coverage, has been shown to enhance productivity, and income composition and national development status reflect broader socioeconomic conditions. Education and population are also recognized as structural drivers of economic growth because educated workers increases human capital, research and innovation for better products, processes and overall economic advancement. 

As economic theory suggests a positive relationship between GDP and improved development indicators, and estimating a linear model allows us to quantify the individual contribution of each predictor to GDP while controlling for the others, a positive relationship between GDP and indicated predictors can be expected. The focus of this analysis is on interpretability, to understand how each predictor relates to economic output and to support evidence-based approaches to development and policy planning.  

# Data description
The dataset used in this project is titled *Life Expectancy* (WHO), sourced from *Kaggle* (Kumar, 2018). Its primary usage is for health data analysis. Data collectors combined publicly available data from the *World Health Organization* (WHO) and the *United Nations* (UN), which were gathered through national health departments, structured questionnaires, and annual statistical submissions by participating countries (World Health Organization, n.d.; United Nations, n.d.). The sample comprises over 1,600 complete observations, focusing on education, demographic, and socioeconomic indicators relevant to economic growth.  

While the dataset was initially intended to examine factors affecting life expectancy, this project selects 7 of the original 22 variables that align with economic theory, which emphasizes the importance of education, health, and human capital in supporting sustained increases in GDP.  

The preliminary model is prone to multiple violations of model assumption, but multiple linear regression is still an appropriate method for analysis, as the scatterplots of the response and each predictor show a huge potential for linear association, constant error variance, and uncorrelated and normal errors, through diagnostic procedures like predictor transformations. 

\
Table 1: Variables used in the model

| **Variable**                    | **Description**                                                                 | **Type**              |
|--------------------------------|---------------------------------------------------------------------------------|------------------------|
| GDP                            | Gross Domestic Product per capita (USD)                                        | Response variable      |
| Status                         | Developed or Developing status                                                 | Categorical variable   |
| Percentage expenditure         | Expenditure on health as a percentage of Gross Domestic Product per capita (%) | Continuous variable       |
| Polio                          | Polio immunization coverage among 1-year-olds (%)                              | Continuous variable       |
| Population                     | Population of the country                                                      | Continuous variable       |
| Income composition of resources| Human Development Index in terms of income composition (index from 0 to 1)     | Continuous variable       |
| Schooling                      | Number of years of schooling (years)                                           | Continuous variable       |


Table 2: Continuous variables summary

| Variable                         |   Mean   |   Std   |   Min   |   Q1   | Median |   Q3   |   Max    |
|----------------------------------|----------|---------|---------|--------|--------|--------|----------|
| GDP                              | 7483.16  | 14270.17| 1.68    | 463.94 |1766.95| 5910.81| 119172.74|
| Percentage expenditure           | 738.25   | 1987.91 | 0.01    | 4.69   | 64.91  |441.53  |19479.91  |
| Polio                            | 82.55    | 23.43   | 3.00    | 78.00  | 93.00  | 97.00  |99.00   |
| Population                       | 1.28e+07 | 6.10e+07| 34.00   | 1.96e+05|1.39e+06|7.42e+06|1.29e+09  |
| Income composition of resources  | 0.63     | 0.21    | 0.00    | 0.49   | 0.68   | 0.78   | 0.95     |
| Schooling                        | 11.99    | 3.36    | 0.00    | 10.10   | 12.30  | 14.30  | 20.70    |

Table 3: Status (categorical variable) frequency

| Status     | Frequency |
|------------|-----------|
| Developing | 2426      |
| Developed  | 512       |
| **Total**  | 2938      |

\
\
\
\
\
\
\
\
\
\
\
\
\
Figure 1: Scatter plots of GDP against numeric predictors  
```{r message=FALSE, echo=FALSE, warning=FALSE, include=FALSE}
packages <- c("tidyverse", "latex2exp", "gridExtra", "rvest", 
              "kableExtra", "leaps", "ggplot2", "patchwork", "car", "MASS")
lapply(packages, require, character.only = T)
set.seed(420)
all_data <- read.csv("life_expectancy.csv")
```

```{r fig.width = 10, fig.length=12, echo=FALSE, message=FALSE, warning=FALSE}
# the matrix
scatter_plot <- function(xvar, xlab) {
  ggplot(all_data, aes_string(x = xvar, y = "GDP")) +
    geom_point(color = "black", alpha = 0.6) +
    geom_smooth(method = "lm", se = FALSE, color = "blue") +
    labs(
      title = paste("GDP vs", xlab),
      x = xlab,
      y = "GDP"
    ) +
    theme_minimal()
}

# Create plots
p1 <- scatter_plot("percentage.expenditure", "Health Percentage expenditure")
p2 <- scatter_plot("Polio", "Polio")
p3 <- scatter_plot("Population", "Population")
p4 <- scatter_plot("Income.composition.of.resources", "Income composition of resources")
p5 <- scatter_plot("Schooling", "Schooling")

# Combine in layout
(p1 | p2 | p3) / (p4 | p5)
```
GDP increases as health percentage expenditure does in a rather compelling linear manner, although the clustering near the lower ends of the domain is concerning due to outliers in countries that are experiencing geopolitical turmoil. GDP and polio as well as income composition of resources and schooling demonstrate weaker positive trends, looking more quadratic, most likely with leverage points at the tails. It's clear that there are bad leverage points in GDP and population. In the context of geography and the complexity of individual states, one can suspend their disbelief easily about certain leverage points, but nonetheless, these need to be dealt with to provide a more accurate prediction of GDP with the set predictors at hand. 


Figure 2: Histogram of GDP & numeric predictors  

\
```{r fig.width = 10, fig.length=12, echo=FALSE, message=FALSE, warning=FALSE}
# Create a common theme with smaller text and better use of space
compact_theme <- theme(
  plot.title = element_text(size = 9, face = "bold"),
  axis.title = element_text(size = 8),
  axis.text = element_text(size = 7),
  plot.margin = margin(3, 3, 3, 3, "pt")
)

# Create the six histograms with the compact theme
p1 <- ggplot(all_data, aes(x = GDP)) +
  geom_histogram(binwidth = 1000, fill = "skyblue", color = "white") +
  labs(title = "Distribution of GDP", x = "GDP", y = "Frequency") +
  scale_x_continuous(
    limits = c(0, 50000),          # Set axis range from 0 to 50,000
    breaks = seq(0, 50000, 10000), # Set tick marks at intervals of 10,000
    labels = scales::comma          # Format numbers with commas
  ) +
  compact_theme

p2 <- ggplot(all_data, aes(x = percentage.expenditure)) +
  geom_histogram(binwidth = 1, fill = "skyblue", color = "white") +
  labs(title = "Distribution of % Expenditure", x = "% Expenditure", y = "Frequency") +
  scale_x_continuous(
    limits = c(0, 100),        # Reduced axis range from 0 to 100
    breaks = seq(0, 100, 20),  # Set tick marks at intervals of 20
    labels = scales::comma      # Format numbers with commas
  ) +
  scale_y_continuous(
    limits = c(0, 100),        # Y-axis range from 0 to 100
    breaks = seq(0, 100, 20)   # Y-axis tick marks at intervals of 20
  ) +
  compact_theme

p3 <- ggplot(all_data, aes(x = Polio)) +
  geom_histogram(binwidth = 2, fill = "skyblue", color = "white") +
  labs(title = "Distribution of Polio", x = "Polio", y = "Frequency") +
  compact_theme

p4 <- ggplot(all_data, aes(x = Population)) +
  geom_histogram(binwidth = 10000000, fill = "skyblue", color = "white") +
  labs(title = "Distribution of Population", x = "Population (billions)", y = "Frequency") +
  scale_x_continuous(
    limits = c(0, 1.2e9),                   # X-axis range from 0 to 1.2 billion
    breaks = seq(0, 1.2e9, 0.2e9),          # X-axis tick marks at intervals of 0.2 billion
    labels = function(x) x/1e9              # Format as billions (0, 0.2, 0.4, etc.)
  ) +
  scale_y_continuous(
    limits = c(0, 500),                    # Y-axis range from 0 to 2500
    breaks = seq(0, 500, 100)              # Y-axis tick marks at intervals of 500
  ) +
  compact_theme

p5 <- ggplot(all_data, aes(x = Income.composition.of.resources)) +
  geom_histogram(binwidth = 0.02, fill = "skyblue", color = "white") +
  labs(title = "Distribution of Income Composition", x = "Income Composition", y = "Frequency") +
  compact_theme

p6 <- ggplot(all_data, aes(x = Schooling)) +
  geom_histogram(binwidth = 0.5, fill = "skyblue", color = "white") +
  labs(title = "Distribution of Schooling", x = "Schooling", y = "Frequency") +
  compact_theme

# Use patchwork to arrange plots with custom layout
library(patchwork)
combined_plot <- (p1 | p2 | p3) / (p4 | p5 | p6)

# Apply global theme adjustments to the combined plot
combined_plot & 
  theme(plot.margin = margin(1, 1, 1, 1, "pt")) &
  plot_layout(guides = "collect")
```
```{r echo=FALSE, message=FALSE, warning=FALSE}
# Boilerplate common theme again
compact_theme <- theme(
  plot.title = element_text(size = 9, face = "bold"),
  axis.title = element_text(size = 8),
  axis.text = element_text(size = 7),
  plot.margin = margin(3, 3, 3, 3, "pt")
)
# boxplot
ggplot(all_data, aes(x = Status, y = GDP)) +
  geom_boxplot(fill = "skyblue") +
  labs(title = "GDP per Capita by Country Status",
       x = "Status",
       y = "GDP per Capita") + coord_cartesian(ylim = c(0, 1e+05))

```
GDP, percentage expenditure, and population are strongly right-skewed, with mostly low values. Schooling and income composition are slightly left-skewed, clustering at the high end. Income composition is also bimodal, although there is potential for a bell-curve-like shape. Polio rates are highly left-skewed. Since country status is a categorical predictor, the boxplot graph is better suited to evaluating the normality assumption. Developed countries have a higher median GDP per capital and wider IQR range, which indicates greater variability than developing countries, which violates a model assumption. Also, developing countries appear highly skewed to the right, with most countries clustered at low GDP per capital values. The long tail of outliers stretching upward indicate a few developing countries with relatively high GDPs. In context, these outlier countries like Malaysia, Mexico, or Turkey are often classified more deeply as upper-middle-income economies (World Bank) because they clearly act as outliers compared to the rest of the developing world. 

# Preliminary model results and diagnostics
```{r, echo=FALSE, message=FALSE, warning=FALSE, include=FALSE}
all_data <- read.csv("life_expectancy.csv", na.strings = c("", "NA"))
anyNA(all_data)
sum(is.na(all_data))
colSums(is.na(all_data))
```
```{r eval=FALSE, echo=FALSE, message=FALSE, warning=FALSE, include=FALSE}
all_data <- read.csv("life_expectancy.csv")
all_data <- na.omit(all_data)

all_data$Status <- as.factor(all_data$Status)


# Clean model
full_model <- lm(GDP ~ Life.expectancy + Status + Adult.Mortality + 
                   infant.deaths + Alcohol + percentage.expenditure + 
                   Hepatitis.B + Measles + BMI + under.five.deaths + Polio +
                   Total.expenditure + Diphtheria + HIV.AIDS + Population +
                   thinness..1.19.years + thinness.5.9.years +
                   Income.composition.of.resources + Schooling,
                 data = all_data)
summary(full_model)

step_model <- step(full_model, direction = "both")
summary(step_model)
```


```{r, fig.width=10, fig.height=7, eval=FALSE, echo=FALSE, message=FALSE, warning=FALSE, include=FALSE}
best_model <- regsubsets(Life.expectancy ~ GDP + Status + Adult.Mortality + 
                           infant.deaths + Alcohol +
                           percentage.expenditure + Hepatitis.B + Measles + 
                           BMI + under.five.deaths + Polio +
                           Total.expenditure + Diphtheria + HIV.AIDS + 
                           Population + thinness..1.19.years + 
                           thinness.5.9.years + Income.composition.of.resources 
                          + Schooling, data = all_data, nvmax = 10)

# Summary and plot
best_summary <- summary(best_model)
plot(best_model, scale = "adjr2")
```
We propose the following multiple linear regression model:
$$
\begin{aligned}
GDP &= \mathbb{E}[\log(GDP)] + e \\
    &= b_0 + b_1 \cdot \text{PercentageExpenditure} + b_2 \cdot \text{Polio} + b_3 \cdot \text{Population} \\
    &\quad + b_4 \cdot \text{IncomeCompositionOfResources} + b_5 \cdot \text{Schooling} + b_6 \cdot \text{Status}
\end{aligned}
$$

Get the response and predictors: 
```{r, echo=FALSE, message=FALSE, warning=FALSE}
all_data <- read.csv("life_expectancy.csv")
all_data <- na.omit(all_data)
all_data$log_GDP <- log(all_data$GDP)

response <- all_data$log_GDP
x0 <- all_data$percentage.expenditure
x1 <- all_data$Polio
x2 <- all_data$Population
x3 <- all_data$Income.composition.of.resources
x4 <- all_data$Schooling

all_data$Status <- as.factor(all_data$Status)

model <- lm(response ~ Status + x0 + x1 + x2 + x3 + x4, data = all_data)
summary(model)
```


We estimate the deterministic model as: 
$$
\begin{aligned}
\hat{GDP} = \exp(&\hat{b_0} + \hat{b_1} \cdot \text{PercentageExpenditure} + \hat{b_2} \cdot \text{Polio} + \hat{b_3} \cdot \text{Population} \\
                &+ \hat{b_4} \cdot \text{IncomeCompositionOfResources} + \hat{b_5} \cdot \text{Schooling} + \hat{b_6} \cdot \text{Status})
\end{aligned}
$$
Initially, the distribution of GDP was heavily right-skewed due to a small number of countries with disproportionately large economies. Residual plots also showed signs of heteroscedasticity, violating regression assumptions. To address this, we applied a log transformation to the response variable, which preserved the interpretability of a linear model while improving the spread of residuals.

The adjusted R-squared of the transformed model was 0.9258, indicating that 92.6% of the variation in GDP is explained by the model. Among numerical predictors, percentage expenditure on health and schooling were both statistically significant (p < 0.001), suggesting strong positive relationships with GDP. This supports the idea that education and health investment enhance human capital and economic productivity (Radcliffe, Raghupathi). For the categorical predictor Status (Developed vs. Developing), the p-value was approximately 0.0038, indicating that developed countries tend to have significantly higher GDPs after accounting for other variables. In contrast, polio immunization and population size were not statistically significant, implying weaker associations.  

The residual plots assess linearity and constant variance assumptions. Residuals were mostly centered around zero, but a slight V-shape indicates some remaining heteroscedasticity, especially at the lower and higher ends of fitted GDP. This suggests more stable residuals in middle-income countries, while richer and poorer countries show more unpredictable patterns. For example, the U.S., Qatar, and Luxembourg all have high GDPs, but for very different reasons (tech, gas, or tax policy). Similarly, lower-income countries may have inconsistent or less reliable data.  

The Q-Q plot showed that residuals were somewhat normal, but skewed left. Residuals versus individual predictors showed random scatter for income composition and schooling, but some structure for expenditure, population, and polio, suggesting potential nonlinearities.  

Overall, the model shows evidence that educational and economic factors influence GDP, though remaining issues with heteroscedasticity and non-normal residuals should be better resolved, as these violations weaken ordinary least squares (OLS) model accuracy. Employing further transformations like Box-Cox, investigating covariance, colinearity, the removal of bad leverage points and outliers, comparison of different models through F-test and analysis of variance (ANOVA), or even exploring weighted least squares (WLS) are key stratagem to confidently predict the expected GDP in a country. 

Figure 3: Linearity and homoscedasticity graphs  
\
```{r, fig.width=13, fig.height=7, echo=FALSE, message=FALSE, warning=FALSE}
par(mfrow = c(2, 2))
plot(model)
```
\

Figure 4: Residual vs each predictor  
\
```{r, fig.width=12, fig.height=8, echo=FALSE, message=FALSE, warning=FALSE}
all_data$residuals <- resid(model)
all_data$fitted <- fitted(model)

p1 <- ggplot(all_data, aes(x = `percentage.expenditure`, y = residuals)) +
  geom_point(alpha = 0.6) +
  geom_hline(yintercept = 0, color = "red", linetype = "dashed") +
  labs(title = "Residuals vs Percentage Expenditure")

p2 <- ggplot(all_data, aes(x = Polio, y = residuals)) +
  geom_point(alpha = 0.6) +
  geom_hline(yintercept = 0, color = "red", linetype = "dashed") +
  labs(title = "Residuals vs Polio")

p3 <- ggplot(all_data, aes(x = Population, y = residuals)) +
  geom_point(alpha = 0.6) +
  geom_hline(yintercept = 0, color = "red", linetype = "dashed") +
  labs(title = "Residuals vs Population")

p4 <- ggplot(all_data, aes(x = `Income.composition.of.resources`, 
                           y = residuals)) +
  geom_point(alpha = 0.6) +
  geom_hline(yintercept = 0, color = "red", linetype = "dashed") +
  labs(title = "Residuals vs Income Composition")

p5 <- ggplot(all_data, aes(x = Schooling, y = residuals)) +
  geom_point(alpha = 0.6) +
  geom_hline(yintercept = 0, color = "red", linetype = "dashed") +
  labs(title = "Residuals vs Schooling")

p6 <- ggplot(all_data, aes(x = as.factor(Status), y = residuals)) +
  geom_jitter(width = 0.2, alpha = 0.6, color = "steelblue") +
  geom_hline(yintercept = 0, linetype = "dashed", color = "red") +
  scale_x_discrete(labels = c("Developing", "Developed")) +
  labs(title = "Residuals vs Status",
       x = "Status",
       y = "Residuals")

(p1 | p2 | p3) / (p4 | p5 | p6)
```

\
Figure 5: Normality graphs  


```{r, fig.width=13, fig.height=12, echo=FALSE, message=FALSE, warning=FALSE}
# Store residuals only once (already done earlier)
all_data$residuals <- resid(model)
all_data$std_residuals <- rstandard(model)

# Q-Q Plot
qq_plot <- ggplot(all_data, aes(sample = residuals)) +
  stat_qq() +
  stat_qq_line(color = "red", linetype = "dashed") +
  labs(title = "Q-Q Plot of Residuals") +
  theme_minimal() +  # Optional: adds a cleaner theme that may help with rendering
  theme(aspect.ratio = 1)  # Makes the plot square, which often helps QQ plots display correctly

# Standardized Q-Q Plot 
std_qq_plot <- ggplot(all_data, aes(sample = std_residuals)) +
  stat_qq() +
  stat_qq_line(color = "red", linetype = "dashed") +
  labs(title = "Q-Q Plot of Standardized Residuals") +
  theme_minimal() +
  theme(aspect.ratio = 1)

# Histogram
hist_plot <- ggplot(all_data, aes(x = residuals)) +
  geom_histogram(bins = 30, fill = "steelblue", color = "white", alpha = 0.7) +
  geom_vline(xintercept = 0, linetype = "dashed", color = "red") +
  labs(title = "Histogram of Residuals", x = "Residuals", y = "Count")

std_hist_plot <- ggplot(all_data, aes(x = std_residuals)) +
  geom_histogram(bins = 30, fill = "steelblue", color = "white", alpha = 0.7) +
  geom_vline(xintercept = 0, linetype = "dashed", color = "red") +
  labs(title = "Histogram of Standardized Residuals", 
       x = "Standardized Residuals", 
       y = "Count")


(qq_plot | std_qq_plot) / (hist_plot / std_hist_plot)
```


# Model selection
From the conclusion in preliminary model diagnostics, the model violated linear regression assumptions and would benefit from modifications. 

The first attempt to fit to the population model was to fit all available predictors from the dataset without transformation using OLS. We then performed best subset selection and stepwise selection. Stepwise selection was done using $step()$ based on Akaike Information Criterion (AIC) and Bayesian Information Critertion (BIC) which filtered the complexity and goodness of fit of the model. Best subset selection was done using $regsubsets()$ from the **leaps** package, which tries all combinations of up to 10 predictors and evaluates them based on adjusted $R^2$. This is **Model 1**. The main issue here was the predictor choice that had been determined by the criterion: Both total expenditure on health and percentage expenditure on health were included in the model, however this is not meaningful as these predictors are just different perspectives of health and GDP spending. Therefore, population replaced the percentage expenditure since population had previously a strong indication on its influence of GDP, and this became **Model 2**.

Then, since this model violated normality of residuals and heteroscedasticity, **Model 3** is the variable transformation of **Model 2**, where Box-Cox was applied to the response, with the result of maximized log-likelihood power parameter $\lambda = 0.101$. This significantly improved the normality and variance stability of the residuals, however, a curvature on the residual and fitted values plot was still observed. 


In order to address the remaining violation, **Model 4** applies transformations on the predictors. Polio and population scatterplots from the introduction exploratory data analysis indicated a potential nonlinear relationship with GDP, therefore, a quadratic  transformation was applied to these two predictors, although improvement on normality violations were not representative in diagnostic graphs.

Therefore, **Model 5** and **Model 6** are the combination of both response and predictor transformations. For these two final candidate models, multicollinearity in the predictors was also assessed through the Variance Inflation Factor (VIF). Both candidates returned VIF values of below 5, a strong indication that multicollinearity was not a concern in either model. In lieu of the research question, multicollinearity is unlikely to be a major concern as these predictors capture distinct phenomena that measure different social mechanisms. Also, predictors that were already expressed as a percentage of a population removes the common size factor that would otherwise cause co-linearity in cross-country data. 

**Model 6** is **Model 5** with an additional observation: Before transforming the population variable, the residual vs. leverage plot exhibited several points with high leverage. This would indicate influence on the fitted line to stray from the population line. As a result, a logarithmic transformation was applied on the population predictor here. This transformation substantially reduced the number and magnitude of bad  high-leverage points and indicates that the model became less sensitive to extreme values in the predictors. 


Table 5: Diagnostic metrics for Models 5 and 6

| Metric       | Model 5   | Model 6   |
|--------------|-----------|-----------|
| $R^2$          | 0.4209    | 0.4249    |
| Adjusted $R^2$  | 0.4188    | 0.4288    |
| AIC          | 8085.524  | 8074.323  |
| BIC          | 8128.788  | 8117.587  |

Table 6: Explanation of transformed variables

| Transformation | Variable(s) | Motivation |
|----------------|-------------|------------|
| Box–Cox $(\lambda \approx 0.101)$ | Response: `GDP`  | Heavy right-skew and non-constant variance in raw GDP; log-like Box–Cox stabilizes variance and improves normality. |
| Quadratic term | `Polio²`, `Schooling²`, `Total.expenditure²` | Scatterplots showed curvature; adding a squared term captures diminishing returns visible in the data. |
| Log scale | Population to `log(Population)` | Original residual-vs-leverage plot had extreme leverage for the largest countries; the log scale compresses the range and removes those high-influence points without discarding data. |

All other predictors remained on their natural scale because residual plots and VIF values (< 5) did not indicate further non-linearity or multicollinearity problems. After removal of the clear outliers, diagnostics (Figure 3, 4) showed homoscedastic residuals and no further influential cases above conventional cut-offs. Dropped predictors were 'percentage.expenditure', because it duplicates health-spending information already captured by `Total.expenditure` and inflates collinearity. Also, other health, demographic, and mortality variables eliminated by stepwise AIC lacked statistical significance ($p > 0.05$) and raised VIFs $> 5$ when retained.  


Table 7: ANOVA Table

| Predictor            | Df | Sum Sq  | Mean Sq | F value  | Pr$(>F)$        |
|----------------------|----|---------|---------|----------|----------------|
| Status               | 1  | 3194.3  | 3194.3  | 584.3467 | 2.2e-16 |
| Total expenditure$^2$   | 1  | 308.6   | 308.6   | 52.9796  | 5.7e-13   |
| Polio                | 1  | 682.4   | 682.4   | 117.1461 | 2.2e-16 |
| $log$-population       | 1  | 10.3    | 10.3    | 1.7096   | 0.1836        |
| Income composition   | 1  | 4114.7  | 4114.7  | 706.3467 | 2.2e-16 |
| Schooling$^2$           | 1  | 75.9    | 75.9    | 13.0305  | 0.000317      |
| Residuals            | 1416 | 8248.6    | 5.8  | —        | —             |

In addition to examining diagnostic plots, overall fit and complexity of the final two models were evaluated with certain metrics. **Model 6** has a larger Adjusted $R^2$ value and smaller AIC and BIC values. To assess the influence of individual observations, Cook’s distance, difference in fits (DFFITS) and leverage values were examined. Removing outliers improved the normality and homoscedasticity of residuals $(126, 2121, 92, 1233)$.  However removing  high leverage or high influence points led to curvature in the residuals vs fitted plot and deviations from normality in the Q-Q plot. This suggests that these points may contain genuine structure in the data necessary for the model to adequately capture relationships. Therefore, we decided to only remove clear outliers based on standardized residuals, while retaining leverage and influential points.

Based on best meeting these criteria, and solving violation assumptions, **Model 6** is our final model for inference and interpretation of GDP by health and socioeconomic predictors. 


```{r, echo=FALSE, message=FALSE, warning=FALSE, include=FALSE}
#Model 0 from preliminary
all_data <- read.csv("life_expectancy.csv")
all_data <- na.omit(all_data)
all_data$Status <- as.factor(all_data$Status)

hist(all_data$Population)
hist(all_data$Schooling)
hist(all_data$Polio)
hist(all_data$Total.expenditure)
hist(all_data$Income.composition.of.resources)


#### This is the original model #######
full_model <- lm(GDP ~ Life.expectancy + Status + Adult.Mortality + 
                   infant.deaths + Alcohol + Total.expenditure + percentage.expenditure+
                   Hepatitis.B + Measles + BMI + under.five.deaths + Polio
                   + Diphtheria + HIV.AIDS + Population +
                   thinness..1.19.years + thinness.5.9.years +
                   Income.composition.of.resources + Schooling,
                 data = all_data)
summary(full_model)

step_model <- step(full_model, direction = "both")
summary(step_model)
```

```{r, echo=FALSE, message=FALSE, warning=FALSE, include=FALSE}

all_data <- read.csv("life_expectancy.csv")
all_data <- na.omit(all_data)
all_data$Status <- as.factor(all_data$Status)

### model1 result of stepwise ####

model1 <- lm(GDP ~ Status + Total.expenditure + Polio+ percentage.expenditure + Income.composition.of.resources
                  + Schooling , data = all_data)
summary(model1)

par(mfrow = c(2, 2))
plot(model1)
```

```{r, echo=FALSE, message=FALSE, warning=FALSE, include=FALSE}
## model2 replace percentage expenditure with population for meaningful interpretation of model coefficients

model2 <- lm(GDP ~ Status + Total.expenditure + Polio + Population + Income.composition.of.resources
                  + Schooling , data = all_data)
summary(model2)

par(mfrow = c(2, 2))
plot(model2)
```

```{r, echo=FALSE, message=FALSE, warning=FALSE, include=FALSE}
## Model 3 Box_Cox tansformed response variable y

bc <- boxcox(model2, plotit = TRUE)
(lambda_optimal <- bc$x[which.max(bc$y)])

all_data$bc_GDP <- (all_data$GDP^0.1010101 - 1)/0.1010101
all_data$Status <- as.factor(all_data$Status)

model3 <- lm(bc_GDP ~ Status + Total.expenditure + Polio + Population 
             + Income.composition.of.resources  + Schooling, data = all_data)
summary(model3)

par(mfrow = c(2, 2))
plot(model3)
```

```{r, echo=FALSE, message=FALSE, warning=FALSE, include=FALSE}
# Model 4 Only squared Polio and Income

model4 <- lm(GDP ~ Status + Total.expenditure
                          + I(Polio^2) + Population + I(Income.composition.of.resources^2)
                              + Schooling, data = all_data)
summary(model4)

par(mfrow = c(2, 2))
plot(model4)
```

```{r, echo=FALSE, message=FALSE, warning=FALSE, include=FALSE}
# Model 5 Combination of box-cox and squared

model5 <- lm(bc_GDP ~ Status + Total.expenditure + I(Polio^2)
             + I(Population^2)
             + Income.composition.of.resources
             + Schooling,
             data = all_data)
summary(model5)

par(mfrow = c(2, 2))
plot(model5)
```

```{r, echo=FALSE, message=FALSE, warning=FALSE}
# Model 6 (Final Model)
# the best model when combine box-cox and squared

model6 <- lm(bc_GDP ~ Status +I(Total.expenditure^2) +Polio
             + I(log(Population))
             + Income.composition.of.resources
             + I(Schooling^2),
             data = all_data)

summary(model6)

par(mfrow = c(2, 2))
plot(model6)

#check multicolinearity
vif(model6)

#check AIC & BIC for all model we have

aic_results <- AIC(model1, model2, model3, model4, model5, model6)
bic_results <- BIC(model1, model2, model3, model4, model5, model6)
print(aic_results)
print(bic_results)


# some plots
mod.resid <- resid(model6)
mod.fitted <- fitted(model6)
mod.sresid <- rstandard(model6)

## Response vs. Fitted plot
plot(mod.fitted,all_data$bc_GDP,xlab="Fitted",ylab="GDP",
     main="Fitted vs Response")
abline(a=0,b=1,col="red",lwd=2)

## Residuals vs Fitted plot
plot(mod.fitted,mod.resid,xlab="Fitted",ylab="Residuals",
     main="Fitted vs. Residuals")
abline(h=0,col="blue",lwd=2)

## QQ plot
qqnorm(mod.sresid); qqline(mod.sresid)
```

```{r, echo=FALSE, message=FALSE, warning=FALSE, include=FALSE}
## check leverage point/ influential point/ outliers

## Leverage points
mod.hii <- hatvalues(model6)
plot(mod.hii,type="h",ylab='hii',main="Leverage values")
## Define the cutoff for leverage points
cutoff.leveragepoints <- 2*(6+1)/nrow(all_data)
cutoff.leveragepoints.bis <- 3*(6+1)/nrow(all_data)
abline(h=cutoff.leveragepoints,col="red")
abline(h=cutoff.leveragepoints.bis,col="blue")
abline(h=0.5,col="green")
mod.hii
which(mod.hii>cutoff.leveragepoints)

## Outliers
plot(mod.sresid,type="h")
abline(h=4,col="red")
abline(h=-4,col="red")
which(abs(mod.sresid)>4)

## Influential points

## 1. Cook's distance
mod.dii <- cooks.distance(model6)
plot(mod.dii,type="h",ylab="Dii")
cutoff_dii <- qf(0.5,df1=7,df2=(nrow(all_data)-6-1))
abline(h=cutoff_dii,col="red")
abline(h=1,col="blue")
abline(h=4/nrow(all_data),col="green")
which(mod.dii>(4/nrow(all_data)))
## Based on the cutoff 4/n

## 2. Difference in fitted values
mod.dffits <- dffits(model6)
plot(mod.dffits,type="h",ylab="DFFITS")
cutoff.dffits <- 2*sqrt(7/nrow(all_data))
abline(h=cutoff.dffits,col="red")
abline(h=-cutoff.dffits,col="red")
which(abs(mod.dffits)>cutoff.dffits)
```

```{r, echo=FALSE, message=FALSE, warning=FALSE}
## remove outliers

remove_invalid <- unique(c(
  which(abs(mod.sresid)>4)
))

clean_data6 <- all_data[-remove_invalid, ]

# clean model

clean_model6 <- lm(bc_GDP ~ Status 
             +I(Total.expenditure^2)
             + Polio
             + I(log(Population))
             + Income.composition.of.resources
             + I(Schooling^2),
             data = clean_data6)
summary(clean_model6)
anova(clean_model6)
par(mfrow = c(2, 2))
plot(clean_model6)
```


# Final model inference and results 
The final regression model consists of six key predictors, all of which were selected and transformed in a way which best explains a country’s GDP. Quadratic and logarithmic are examples of the transformations applied to the predictors for the final model. The response is also transformed using the Box-Cox transformation method, due to the violation of the normality assumption. This final model helps accurately address the extent to which government spending on health and socioeconomic resources affects a country’s GDP. 
\
\
\
\
With Box-Cox transformation parameter $\lambda = 0.101$, the estimated model is:
\begin{align*}
\widehat{Y}^{(0.101)} &= \frac{\widehat{Y}^{0.101} - 1}{0.101} \\
&= \beta_0 + \beta_1 X_{\text{Status}} + \beta_2 X_{\text{TotalExpenditure}}^2 + \beta_3 X_{\text{Polio}} \\
&\quad + \beta_4 \log(X_{\text{Population}}) + \beta_5 X_{\text{IncomeCompositionofResources}} + \beta_6 X_{\text{Schooling}}^2 + \varepsilon
\end{align*}


Table 8: Final Model Summary Table at 0.05 Confidence Level


| Predictor           | Estimate | Std. Error | t value | Pr(>|t|)     | 2.5%    | 97.5%   |
|---------------------|----------|------------|---------|--------------|---------|---------|
| (Intercept)         | 6.3298   | 0.5977     | 10.591  | < 2e-16  | 5.1575  | 7.5021  |
| Status              | -1.2452  | 0.2340     | -5.321  | 1.18e-7  | -1.7043 | -0.7862 |
| Total Expenditure   | 0.0036   | 0.0024     | 1.473   | 0.141        | -0.0012 | 0.0083  |
| Polio               | -0.0033  | 0.0032     | -1.032  | 0.302        | -0.0097 | 0.0030  |
| Population          | -0.0022  | 0.0250     | -0.088  | 0.930        | -0.0513 | 0.0468  |
| Income Composition  | 4.1549   | 0.5912     | 7.028   | 3.07e-12 | 2.9953  | 5.3146  |
| Schooling           | 0.0222   | 0.0017     | 12.733  | < 2e-16  | 0.0188  | 0.0257  |

### Intercept:
When all predictors are equal to 0, the estimated average value of the Box-Cox-transformed GDP (BC-GDP) is 6.3298. In other words, when all other factors are zero, such as status and total expenditure, the on the transformed scale, the response is only comprised of the intercept. Realistically, the intercept is not very useful by itself, as it does not make much sense for some of the predictors to be zero, and is not strictly in the range of GDP realizations. 

### Status:
Status is a categorical predictor with two levels, **developing** and **developed**, where the developing category is set as the dummy variable. Thus, when the country’s status is developing, -1.2452 is the intercept of the developing category minus the developed category. This indicates a negative relationship between a developing status and BC-GDP. When the status is developing, the expected response decreases by 1.2452 on the transformed scale. This aligns with what is expected as a developing country generally has less spending on health and socioeconomic resources, resulting in less human capital, and thus a lower BC-GDP.

### Total Expenditure (squared):
The coefficient for total expenditure squared is 0.0036. Since this predictor is squared and there is no corresponding linear term, the relationship between total expenditure and Box-Cox-transformed GDP (BC-GDP) is monotonically increasing over the range of observed values. This means that as total expenditure increases, expected BC-GDP also increases, and does so at an accelerating rate. In other words, higher levels of health spending are associated with disproportionately larger increases in GDP. The positive coefficient reflects that greater investment in healthcare may yield increasing returns to economic output. Countries that allocate more of their national budget to healthcare (as a share of GDP) tend to experience disproportionately greater economic benefits, likely due to improvements in population health, worker productivity, and reduced disease burden. These effects may compound over time, contributing to long-term growth and economic resilience. However, it is important to interpret this cautiously. While the squared term shows a strong association in the model, it does not capture causal mechanisms. The direction of the relationship may also reflect reverse causality, because countries with higher GDP may have more resources to spend on health. Nonetheless, the presence of a nonlinear positive association supports the idea that health is a productive form of investment, particularly for countries already investing at moderate-to-high levels, and is a good use of this dataset. 

### Polio:
The variable Polio in the dataset refers to polio immunization coverage among 1-year-olds. The estimated coefficient is –0.0033, suggesting a very slight negative association between immunization coverage and BC-GDP. However, this relationship is not statistically significant (p = 0.302), so we cannot confidently conclude that polio immunization coverage meaningfully affects GDP in this model after adjusting for other variables. Polio refers to immunization coverage, a very specific health outcome, so total expenditure could partially explain polio immunization coverage, but not fully. 

### Population (log):
The coefficient for the natural log of population size is –0.0022. However, this effect is extremely small and statistically insignificant because p = 0.930. After accounting for other variables such as education, income composition, and health investment, population size does not significantly explain additional variation in GDP in this model. The negative sign may reflect challenges in large populations, but the data do not support a meaningful relationship here.

### Income Composition of Resources:
For every 1-unit increase in the income composition of resources index (on a 0–1 scale), the estimated average change in BC-GDP is 4.1549, holding all other predictors constant. Since the index reflects broader access to income and opportunity — not just raw GDP or natural resource wealth — this result suggests that countries with higher levels of income-based human development tend to have significantly higher GDP per capita. This aligns with economic theory: greater income equity and opportunity enable broader participation in economic activity, driving growth.

### Schooling (squared):
The coefficient for schooling squared is 0.0222. Since only the squared term is included (with no linear component), the model implies a monotonic and accelerating positive relationship between years of schooling and BC-GDP. As the average number of school years increases, BC-GDP increases and does so more steeply at higher levels of education. This supports one of the strongest theories in economics that education builds human capital, and higher educational attainment translates into stronger economic output. 

### Model Evaluation Using Performance Metrics:
Using appropriate metrics to assess model performance is essential for evaluating the strength of the relationship between the predictors and the response variable and for selecting the best-fitting model.

One common metric is the **coefficient of determination**, $R^2$, which measures the proportion of variance in the response variable (on the transformed scale) that is explained by the model. It ranges from 0 to 1, where values closer to 1 indicate a stronger relationship and better explanatory power. However, $R^2$ always increases when more variables are added, even if those variables are not meaningful. Therefore, it is not always a reliable measure for comparing models, as our dataset contains cross-country economic and health data, which naturally includes a lot of heterogeneity. There are different regions, income levels, government systems, and data reliability.

To address this, we use **Adjusted $R^2$**, which adjusts for the number of predictors in the model and only increases when a new predictor improves the model more than expected by chance. This makes Adjusted $R^2$ more appropriate for comparing models, especially when using transformed responses, such as in our final model, which uses a Box-Cox transformation and many predictor transformations. While 

In our final model **Model 6** (clean_model6 in code), $R^2 = 0.4343$ which means that about 43.4% (nearly half) of the variance in the transformed GDP can be explained by the model. The Adjusted $R^2 = 0.4322$ is a decently strong value, because modeling complex human and economic behavior with only 6 predictors is simple and simplistic when much of GDP variation may be driven by factors not observed in the dataset. For example, superfluous political institutions, international trade policies, or cultural factors. 

While not exceptionally high, these values reflect a meaningful relationship given the diversity of countries, economies, and the inherent noise in cross-country economic data.

In addition to these, we used **likelihood-based criteria**, the **AIC (Akaike Information Criterion)** and **BIC (Bayesian Information Criterion)**. These penalize model complexity and are especially useful for comparing multiple competing models. Both AIC and BIC aim to identify the most parsimonious model that balances fit and complexity, where lower AIC/BIC values are preferred. Since our goal was not just prediction but interpretability, selecting a model with good AIC/BIC and trading off $R^2$ and Adjusted $R^2$ helps reduce overfitting of data. Our final model had the lowest values across all candidate models with AIC = 8074.323 and BIC = 8117.587. 

Together, Adjusted  $R^2$, AIC, and BIC all support the choice of **Model 6** (clean_model6 in code) as the best-performing model. 

# Discussion and conclusion
Our project aims to investigate the impact of health expenditure and socioeconomic factors on GDP per capita in countries. After data cleaning, exploratory analysis, and model selection, our final model is **Model 6** (clean_model6 in code), which uses the Box-Cox transformed GDP as the response variable, and quadratic and log transformations in some of the predictors. The six predictors are Status, Total Expenditure$^2$, Polio, $log$(Population), Income Composition, and Schooling$^2$. 

From MLR diagnostic results, we have reason to believe that health and socioeconomic variables do contribute meaningfully to explaining international differences in GDP, though some variation remains beyond what can be captured by the selected predictors.

**Final Model (Box-Cox Transformed GDP, $\lambda = 0.101$):**
$$
\begin{aligned}
\hat{Y}^{(0.101)} =\ & 6.3298 - 1.2452 \cdot \text{Status}_{\text{Developing}} \\
& +\ 0.0036 \cdot \text{TotalExpenditure}^2 
- 0.0033 \cdot \text{Polio} \\
& -\ 0.0022 \cdot \log(\text{Population}) 
+ 4.1549 \cdot \text{IncomeComposition} \\
& +\ 0.0222 \cdot \text{Schooling}^2
\end{aligned}
$$

The analysis demonstrates that among all the variables considered, education and income composition are the most influential and statistically significant determinants of GDP. A country's economic performance is mainly affected by the level of education and the fairness of income distribution. In contrast, factors such as health expenditure, population size, and immunization rates have strong limited impact on economic outcomes and are generally not statistically significant. This conclusion is supported by our final regression model, which explains about 93% of the variation in GDP (adjusted R-squared $\approx 0.93$). Specifically, the coefficient of schooling$^2$ is positive (0.0222) and highly significant $(p < 2e-16)$, indicating that investment in education has a strong nonlinear positive impact on economic performance. Similarly, income composition has a coefficient of 4.1549 $(p = 3.07e-12 )$, highlighting the importance of inclusive growth and equitable resource allocation. Other factors, including health expenditure, population, and immunization coverage, do not show significant effects in the presence of the main predictors. 

### Limitations:
Although the final model demonstrates a high adjusted R-squared value and strong predictive power, several limitations should be acknowledged. Firstly, while our model identifies statistical correlations between the predictors and GDP per capita, the cross-sectional nature of our dataset prevents us from determining whether these factors are direct causes of economic growth. Because cross-sectional data only capture the circumstances of each country at a single point in time, we can assess associations but cannot establish causal relationships.  

Secondly, the reliability of our estimates may be affected by measurement errors and omitted variable bias. Some key predictors, such as health expenditure and immunization coverage, may be subject to measurement errors or inconsistencies in reporting standards across countries, resulting in potential data quality issues. Furthermore, although we included major socioeconomic and health-related variables, our model does not account for all possible factors that may influence GDP, such as political stability, technological progress, or international trade. Omitting these important variables could bias the results and lead to inaccurate estimates of the effects of the included predictors.  

Lastly, our findings are based on the specific countries and time period covered by our dataset, which may limit the generalizability of our results. The results of this study may not necessarily apply to countries with very different social, economic, or political backgrounds, or other periods marked by major global changes.  

### Recommendations:
Our analysis suggests that improving education and making income distribution fairer are two of the most effective ways for countries to boost their economic growth. We recommend that governments continue to invest in education, making sure that access and quality are improved for everyone, not just a small group. Creating policies that support more equal opportunities and reduce large gaps between the rich and the poor can also have a positive impact on the overall economy.  

While spending on health and immunization did not show a strong direct effect on GDP in our results, these areas are still important for the well-being of a country’s population and may influence growth in ways our model didn’t capture. For this reason, we suggest not overlooking investments in public health. Lastly, we encourage policymakers to look at the bigger picture by considering a range of social and economic factors and to support better, more reliable data collection for future studies.  

### Improvements:
There are several ways our analysis could be improved in future studies. First, including more variables, for example, political stability, infrastructure, technological progress, or even cultural differences, could demonstrate a fuller picture of what drives economic growth. Another way to improve would be to try out different types of statistical models, not just linear regression, to see if they capture relationships between variables better. Finally, making sure data from different countries is as consistent and accurate as possible will help strengthen the findings.
	
In conclusion, our analysis demonstrates that education and income composition are the two most important factors associated with a country's GDP per capita. Countries with higher education levels and more equitable income distribution tend to have better economic performance. In contrast, when education and income are taken into account, factors such as health spending, population size, and immunization rates do not have a significant direct impact on GDP. While our results highlight the key role of human capital and equitable growth in economic development, they are subject to some limitations in the data and analysis. Future research with more comprehensive data and additional variables could help provide a deeper understanding of the complex factors that influence economic growth.  

\
\
\
\

# Author contributions
Sharon Lam: Introduction, Final Model Inference and Results

Shencen Cai: Data Description, Discussion and Conclusion

Erin Xu: Introduction, Preliminary Results, R Code, Model Selection, Bibliography

Dora Dong: Preliminary Results, R Code, Model Selection


# References 

