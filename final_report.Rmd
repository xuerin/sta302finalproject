---
title:  "Modeling GDP Using Health and Socioeconomic Indicators"
author: "Erin Xu, Dora Dong, Shencen Cai, Sharon Lam"
date: "2025-06-12"
output: 
  pdf_document:
    extra_dependencies: ["bbm"]
urlcolor: blue
bibliography: references.bib
nocite: '@*'
link-citations: true
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

#log transform
```{r fig.width = 10, fig.length=12, echo=FALSE, message=FALSE, warning=FALSE}
library(patchwork)
all_data <- read.csv("Life_Expectancy_Data.csv")
all_data <- na.omit(all_data)
all_data$log_GDP <- log(all_data$GDP)
all_data$log_expenditure <- log(all_data$percentage.expenditure)


scatter_plot <- function(xvar, xlab) {
  ggplot(all_data, aes(x = .data[[xvar]], y = log_GDP)) +
  geom_point(alpha = 0.4) +
  geom_smooth(method = "lm", color = "blue", se = FALSE) +
  labs(title = paste("log_GDP vs", xlab),
       x = xlab,
       y = "log_GDP") +
  theme_minimal()
}

p1 <- scatter_plot("log_expenditure", "Percentage expenditure")
p2 <- scatter_plot("log_Polio", "Polio")
p3 <- scatter_plot("Population", "Population")
p4 <- scatter_plot("Income.composition.of.resources", "Income composition of resources")
p5 <- scatter_plot("Schooling", "Schooling")

# Combine in layout
(p1 | p2 | p3) / (p4 | p5)
```
