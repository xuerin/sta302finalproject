---
title:  "Modeling GDP Using Health and Socioeconomic Indicators"
author: "Erin Xu, Dora Dong, Shencen Cai, Sharon Lam"
date: "2025-06-12"
output: 
  pdf_document:
    extra_dependencies: ["bbm"]
urlcolor: blue
bibliography: references.bib
nocite: '@*'
link-citations: true
---

### original model ###
```{r, echo=FALSE, message=FALSE, warning=FALSE}
library(MASS)

all_data <- read.csv("Life_Expectancy_Data.csv")
all_data <- na.omit(all_data)

response <- all_data$GDP
x0 <- all_data$percentage.expenditure
x1 <- all_data$Polio
x2 <- all_data$Population
x3 <- all_data$Income.composition.of.resources
x4 <- all_data$Schooling
all_data$Status <- as.factor(all_data$Status)

model0 <- lm(response ~ Status + x0 + x1 + x2 + x3 + x4, data = all_data)
summary(model0)

par(mfrow = c(2, 2))
plot(model0)

#### box-cox (Î»=0.3) 
bc <- boxcox(model0, plotit = TRUE)
(lambda_optimal <- bc$x[which.max(bc$y)])
``` 

### model 1 box-cox transformation ###

```{r, echo=FALSE, message=FALSE, warning=FALSE}
all_data <- read.csv("Life_Expectancy_Data.csv")
all_data <- na.omit(all_data)

all_data$GDP_bc <- (all_data$GDP^0.3030303 - 1)/0.3030303
response <- all_data$GDP_bc
all_data$Status <- as.factor(all_data$Status)

model <- lm(response ~ Status + all_data$percentage.expenditure + all_data$Polio + all_data$Population + all_data$Income.composition.of.resources  
                              + all_data$Schooling, data = all_data)
summary(model)

par(mfrow = c(2, 2))
plot(model)
```


#### Model 2 log-transformed expenditure ###
```{r, echo=FALSE, message=FALSE, warning=FALSE}
all_data <- read.csv("Life_Expectancy_Data.csv")
all_data <- na.omit(all_data)

all_data$bc_GDP <- (all_data$GDP^0.3030303 - 1)/0.3030303
all_data$log_expenditure <- log(all_data$percentage.expenditure)

all_data <- all_data[is.finite(all_data$bc_GDP) & is.finite(all_data$log_expenditure), ]

response <- all_data$bc_GDP
x0 <- all_data$log_expenditure
x1 <- all_data$Polio
x2 <- all_data$Population
x3 <- all_data$Income.composition.of.resources
x4 <- all_data$Schooling

all_data$Status <- as.factor(all_data$Status)

model2 <- lm(response ~ Status + x0 + x1 + x2 + x3 + x4, data = all_data)
summary(model2)

vif(model2)

par(mfrow = c(2, 2))
plot(model2)
```







